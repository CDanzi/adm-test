<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<contentHaul xmlns:a="http://www.appian.com/ae/types/2009">
    <versionUuid>_a-0000e0b7-c14e-8000-10cb-01ef9001ef90_25681</versionUuid>
    <rule>
        <name>CASE_APP_uiGridProductsForOrder</name>
        <uuid>3ad1404e-fd3d-496a-9033-789297edc4cb</uuid>
        <description>Displays a paging grid with product information in a specified order.
To test, set orderItems to:
rule!CASE_APP_getAllOrderFieldsbyID(rf!id).OrderItems
and set value for isSelectable</description>
        <parentUuid>_a-0000d9c4-bcac-8000-9ba2-011c48011c48_5995</parentUuid>
        <visibility>
            <advertise>false</advertise>
            <hierarchy>true</hierarchy>
            <indexable>true</indexable>
            <quota>false</quota>
            <searchable>true</searchable>
            <system>false</system>
            <unlogged>false</unlogged>
        </visibility>
        <definition>/*To Test:&#xD;
1) Set orderItems to rule!CASE_APP_getAllOrderFieldsbyID(Orderid).OrderItems&#xD;
2) Set gridSelection to a!gridSelection(pagingInfo:a!pagingInfo(1,5,null)&#xD;
*/&#xD;
with(&#xD;
  local!gridData: todatasubset(ri!orderItems, ri!gridSelection.pagingInfo), &#xD;
  #"SYSTEM_SYSRULES_gridField"(&#xD;
    totalCount:local!gridData.totalCount,&#xD;
    columns:{&#xD;
      #"SYSTEM_SYSRULES_gridImageColumn"(&#xD;
        label:"Image",&#xD;
        field:"image",&#xD;
        data:apply(&#xD;
          #"SYSTEM_SYSRULES_documentImage"(document:_),&#xD;
          local!gridData.data.product.productImageDocId&#xD;
        )&#xD;
      ),&#xD;
      #"SYSTEM_SYSRULES_gridTextColumn"(&#xD;
        label:"Product",&#xD;
        field:"Product.name",&#xD;
        data:index(local!gridData.data.Product,"name",{})&#xD;
      ),&#xD;
     #"SYSTEM_SYSRULES_gridTextColumn"(&#xD;
          label:"SKU",&#xD;
          field:"Product.sku",&#xD;
          data:index(local!gridData.data.Product,"sku",{}),&#xD;
          links:apply(&#xD;
            #"SYSTEM_SYSRULES_recordLink"(&#xD;
              recordType:#"_a-0000d9c4-bcac-8000-9ba2-011c48011c48_3830",&#xD;
              identifier:_),&#xD;
           index(local!gridData.data.Product,"id",{})&#xD;
          )&#xD;
        ),       &#xD;
      #"SYSTEM_SYSRULES_gridTextColumn"(&#xD;
        label:"Inventory",&#xD;
        field:"Product.quantity",&#xD;
        data:index(local!gridData.data.Product,"quantity",{})&#xD;
      ),&#xD;
      #"SYSTEM_SYSRULES_gridTextColumn"(&#xD;
        label:"QTY",&#xD;
        field:"Quantity",&#xD;
        data:index(local!gridData.data,"quantity",{})&#xD;
      ),&#xD;
      #"SYSTEM_SYSRULES_gridTextColumn"(&#xD;
        label:"Unit Price",&#xD;
        field:"Product.price",&#xD;
        data:apply(&#xD;
          fn!dollar,&#xD;
          index(local!gridData.data.Product,"price",{})&#xD;
        )&#xD;
      ),&#xD;
      #"SYSTEM_SYSRULES_gridTextColumn"(&#xD;
        label:"Total", &#xD;
        field: "fake",&#xD;
        data:apply(&#xD;
          fn!dollar,&#xD;
          index(local!gridData.data,"quantity",{})*index(local!gridData.data.Product,"price",{})&#xD;
        )&#xD;
      ),&#xD;
      #"SYSTEM_SYSRULES_gridImageColumn"(&#xD;
        label:"Taxed?",&#xD;
        field:"Taxed",&#xD;
        data:apply(&#xD;
          #"_a-0000da5f-caaa-8000-9ba2-011c48011c48_2604",&#xD;
          index(local!gridData.data,"Taxed",{})&#xD;
        ),&#xD;
        size:"ICON"&#xD;
      )&#xD;
    },&#xD;
    identifiers:local!gridData.data.id,&#xD;
    value:ri!gridSelection,&#xD;
    saveInto:{&#xD;
      ri!gridSelection,&#xD;
      a!save(&#xD;
        target: ri!selectedOrderItemId,&#xD;
        value: ri!gridSelection.selected&#xD;
      )&#xD;
    },&#xD;
    selection: ri!isSelectable,&#xD;
    requireSelection: ri!isSelectable,&#xD;
    validations: if(&#xD;
      count(ri!gridSelection.selected) &gt; if(#"_a-0000d9a9-eb56-8000-9e06-010000010000_751"(ri!maxSelection),1,ri!maxSelection),&#xD;
      "You may only select " &amp; if(#"_a-0000d9a9-eb56-8000-9e06-010000010000_751"(ri!maxSelection), "1", ri!maxSelection) &amp; " product",&#xD;
      null&#xD;
    )&#xD;
  )&#xD;
)</definition>
        <namedTypedValue>
            <name>orderItems</name>
            <type>
                <name>CASE_APP_OrderItem?list</name>
                <namespace>urn:com:appian:types:CASE_APP</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>isSelectable</name>
            <type>
                <name>boolean</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>selectedOrderItemId</name>
            <type>
                <name>int</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>gridSelection</name>
            <type>
                <name>Variant</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>maxSelection</name>
            <type>
                <name>int</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
        </namedTypedValue>
        <preferredEditor>interface</preferredEditor>
        <offlineEnabled>false</offlineEnabled>
    </rule>
    <roleMap public="true">
        <role inherit="true" allowForAll="false" name="readers">
            <users/>
            <groups/>
        </role>
        <role inherit="true" allowForAll="false" name="authors">
            <users/>
            <groups/>
        </role>
        <role inherit="true" allowForAll="false" name="administrators">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyReaders">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyAuthors">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyAdministrators">
            <users/>
            <groups/>
        </role>
    </roleMap>
    <typedValue>
        <type>
            <name>RuleTestConfig?list</name>
            <namespace>http://www.appian.com/ae/types/2009</namespace>
        </type>
        <value>
            <el>
                <a:name/>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true"/>
                    <a:nameRef>orderItems</a:nameRef>
                    <a:id/>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true" xsi:type="xsd:boolean"/>
                    <a:nameRef>isSelectable</a:nameRef>
                    <a:id/>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true" xsi:type="xsd:int"/>
                    <a:nameRef>selectedOrderItemId</a:nameRef>
                    <a:id/>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xsd:string"/>
                    <a:nameRef>gridSelection</a:nameRef>
                    <a:id/>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true" xsi:type="xsd:int"/>
                    <a:nameRef>maxSelection</a:nameRef>
                    <a:id/>
                </a:ruleInputTestConfigs>
                <a:assertions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true"/>
            </el>
        </value>
    </typedValue>
    <history>
        <historyInfo versionUuid="_a-0000e0b7-c14e-8000-10cb-01ef9001ef90_25681"/>
    </history>
</contentHaul>
